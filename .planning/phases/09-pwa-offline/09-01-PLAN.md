---
phase: 09-pwa-offline
plan: 01
title: "PWA plugin setup, manifest, and icons"
requirements: [PWA-01, PWA-02, PWA-04]
depends_on: []
estimated_tasks: 3

must_haves:
  - "vite-plugin-pwa is installed as a dev dependency"
  - "VitePWA plugin is added to vite.config.ts with generateSW strategy, registerType: 'prompt', manifest with name/short_name/icons/display/start_url, and workbox globPatterns covering js/css/html/ico/png/svg/woff2"
  - "tsconfig.app.json types array includes 'vite-plugin-pwa/react' for virtual module type declarations"
  - "public/ contains pwa-192x192.png and pwa-512x512.png icon files"
  - "index.html title updated from 'gsd-vite-scaffold' to 'Expense Splitter'"
  - "npm run build succeeds with service worker files (sw.js, workbox-*.js) generated in dist/"
  - "manifest.webmanifest is generated in dist/ with correct name, icons, display: standalone"

key_links:
  - from: "vite.config.ts"
    to: "vite-plugin-pwa"
    via: "import { VitePWA } from 'vite-plugin-pwa' and plugins array"
  - from: "tsconfig.app.json"
    to: "vite-plugin-pwa/react"
    via: "types array for virtual:pwa-register module declarations"
---

# Plan 09-01: PWA Plugin Setup, Manifest, and Icons

## Goal

Install vite-plugin-pwa, configure the service worker and web app manifest, create app icons, and update the HTML title — so the app can be installed on mobile home screens and all assets are precached for offline use.

## Context

- Current `vite.config.ts` has react() and tailwindcss() plugins only
- Current `tsconfig.app.json` has `"types": ["vite/client"]`
- Current `index.html` has `<title>gsd-vite-scaffold</title>`
- Current `public/` contains only `vite.svg`
- Research: `.planning/research/PWA.md` — vite-plugin-pwa v1.2.0 with generateSW

## Tasks

### Task 1: Install vite-plugin-pwa and configure Vite

**Do:**
1. Run `npm install -D vite-plugin-pwa`
2. Edit `vite.config.ts`:
   - Add `import { VitePWA } from 'vite-plugin-pwa'`
   - Add `VitePWA({...})` to the plugins array after `tailwindcss()`
   - Configuration:
     ```typescript
     VitePWA({
       registerType: 'prompt',
       includeAssets: ['**/*'],
       manifest: {
         name: 'Expense Splitter',
         short_name: 'Splitter',
         description: 'Split restaurant bills fairly with friends',
         theme_color: '#030712',
         background_color: '#030712',
         display: 'standalone',
         scope: '/',
         start_url: '/',
         icons: [
           { src: '/pwa-192x192.png', sizes: '192x192', type: 'image/png' },
           { src: '/pwa-512x512.png', sizes: '512x512', type: 'image/png' },
           { src: '/pwa-512x512.png', sizes: '512x512', type: 'image/png', purpose: 'maskable' },
         ],
       },
       workbox: {
         globPatterns: ['**/*.{js,css,html,ico,png,svg,woff2}'],
       },
     })
     ```
   - Note: `theme_color` and `background_color` use `#030712` (gray-950) to match the dark theme

**Verify:**
- `npm run build` succeeds
- `dist/` contains `sw.js`, `workbox-*.js`, and `manifest.webmanifest`
- `manifest.webmanifest` contains correct name, icons, and display fields

### Task 2: Create PWA icons and update HTML

**Do:**
1. Generate two simple PNG icons for `public/`:
   - `pwa-192x192.png` — 192x192 with a simple receipt/split icon on gray-950 background
   - `pwa-512x512.png` — 512x512 same design
   - Use a programmatic approach: create simple SVG-to-PNG or use a solid color square with text as placeholder. The icons should be recognizable on a home screen.
2. Edit `index.html`:
   - Change `<title>gsd-vite-scaffold</title>` to `<title>Expense Splitter</title>`
   - Change favicon link from `vite.svg` to a proper icon (or leave as-is if vite.svg is fine for browser tabs)
3. Add `<meta name="theme-color" content="#030712">` to `index.html` `<head>` for mobile browser chrome color

**Verify:**
- Both PNG files exist in `public/`
- `index.html` has updated title
- `npm run build` succeeds

### Task 3: Update TypeScript configuration

**Do:**
1. Edit `tsconfig.app.json`:
   - Change `"types": ["vite/client"]` to `"types": ["vite/client", "vite-plugin-pwa/react"]`

**Verify:**
- `npx tsc --noEmit` passes (zero errors)
- The virtual module `virtual:pwa-register/react` is recognized by TypeScript (needed for Plan 09-02)

## Acceptance

After this plan:
- `npm run build` produces `dist/sw.js`, `dist/workbox-*.js`, `dist/manifest.webmanifest`
- The manifest has correct app name, icons, and standalone display
- TypeScript recognizes `virtual:pwa-register/react` imports
- All existing 144 tests still pass
- The app can be installed from Chrome's address bar install icon (human verification in preview mode)
